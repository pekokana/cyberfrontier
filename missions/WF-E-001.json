{
	"mission_id": "WF-E-002",
	"version": "1.2",
	"title": "PortScanとネットワークマッピングによるサーバー探索",
	"category": "Network",
	"difficulty": "Easy",
	"description": "初期アラートにより、ネットワーク内に「役割不明の不審なサーバー」が存在することが判明しました。PortScan機能とネットワークマッピングビューアを駆使し、ターゲットサーバー（**192.168.1.100**）の**開放ポート**を特定してください。",

	"setup": {
		"target_server": "192.168.1.100",
		"required_tool": ["Terminal", "PortScanner", "NetworkMap"],
		"network_config": {
			"ip_address": "192.168.1.1",
			"gateway": "192.168.1.10",
			"scan_data": {
				"192.168.1.1": { "name": "User Console", "map_pos": [50, 400], "ports": {} },
				"192.168.1.10": { "name": "Internal Router", "map_pos": [300, 400], "ports": {} },
				"192.168.1.50": { "name": "Mail Server", "map_pos": [550, 200], "ports": {"25": "SMTP", "110": "POP3"} },
				"192.168.1.100": { "name": "Hidden Web Server", "map_pos": [550, 600], "ports": {"80": "HTTP"} }
			},
			"connections": [
				{ "from": "192.168.1.1", "to": "192.168.1.10" },
				{ "from": "192.168.1.10", "to": "192.168.1.50" },
				{ "from": "192.168.1.10", "to": "192.168.1.100" }
			]
		},
		"initial_files": []
	},

	"timing": {
		"has_time_limit": false
	},

	"clear_condition": {
		"type": "flag_submission",
		"solution_label": "ターゲットサーバーの開放ポート番号（例: 80,443）を入力してください:",
		"flag": "80", 
		"case_sensitive": false
	},

	"steps": [
		{
			"step_id": 1,
			"hint": "まずはネットワーク全体を俯瞰しましょう。サイドバーから『NetworkMap』を起動し、ノード一覧と接続を確認してください。",
			"action": "tool_launch"
		},
		{
			"step_id": 2,
			"hint": "不審なサーバーのIPアドレス（**192.168.1.100**）が分かりました。Terminalに戻り、**PortScanner**機能を使ってこのサーバーをスキャンしてください。",
			"action": "tool_launch"
		}
	]
}
