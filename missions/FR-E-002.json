{
  "mission_id": "FR-E-002",
  "version": "1.1",
  "title": "ターミナルとgrepによる不審ログの特定",
  "category": "Forensics",
  "difficulty": "Easy",
  "description": "システム監視中に、特定のサーバーに対する異常なログイン試行が検知されました。提供されたログファイル（auth.log）を分析し、ログイン失敗（Failed）の総回数を特定してください。",

  "setup": {
	"target_server": "192.168.1.5",
	"required_tool": ["Terminal", "FileExplorer"],
	"initial_files": [
	  {
		"path": "/home/user/logs/auth.log",
		"type": "text",
		"description": "サーバーの認証ログファイル。ログイン成功（Accepted）と失敗（Failed）の記録が含まれる。"
	  }
	]
  },

  "timing": {
	"has_time_limit": false
  },

  "clear_condition": {
	"type": "flag_submission",
	"solution_label": "ログイン失敗の総回数を数字で入力してください:",
	"flag": "23", 
	"case_sensitive": false
  },

  "steps": [
	{
	  "step_id": 1,
	  "hint": "Terminalでファイル一覧を表示し、ログファイルがどこにあるかを確認しましょう。`ls /home/user/logs`",
	  "action": "terminal_input"
	},
	{
	  "step_id": 2,
	  "hint": "ターゲットのログファイル（auth.log）の中身を確認してください。失敗したログイン試行を示すキーワードは何でしょうか？`cat /home/user/logs/auth.log | grep Failed`",
	  "action": "terminal_input"
	},
	{
	  "step_id": 3,
	  "hint": "『Failed』の文字列でフィルタリングできたら、その行数をカウントすることで総失敗回数がわかります。`grep Failed /home/user/logs/auth.log | wc -l`",
	  "action": "terminal_input"
	}
  ]
}
